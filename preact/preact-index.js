!function(){"use strict";var e,t,n,_,l,r={},o=[],u=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function i(e,t){for(var n in t)e[n]=t[n];return e}function c(e){var t=e.parentNode;t&&t.removeChild(e)}function s(e,t,n){var _,l,r,o=arguments,u={};for(r in t)"key"==r?_=t[r]:"ref"==r?l=t[r]:u[r]=t[r];if(arguments.length>3)for(n=[n],r=3;r<arguments.length;r++)n.push(o[r]);if(null!=n&&(u.children=n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===u[r]&&(u[r]=e.defaultProps[r]);return a(e,u,_,l,null)}function a(t,n,_,l,r){var o={type:t,props:n,key:_,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r};return null==r&&(o.__v=o),null!=e.vnode&&e.vnode(o),o}function f(e){return e.children}function p(e,t){this.props=e,this.context=t}function h(e,t){if(null==t)return e.__?h(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?h(e):null}function d(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return d(e)}}function v(l){(!l.__d&&(l.__d=!0)&&t.push(l)&&!y.__r++||_!==e.debounceRendering)&&((_=e.debounceRendering)||n)(y)}function y(){for(var e;y.__r=t.length;)e=t.sort((function(e,t){return e.__v.__b-t.__v.__b})),t=[],e.some((function(e){var t,n,_,l,r,o,u;e.__d&&(o=(r=(t=e).__v).__e,(u=t.__P)&&(n=[],(_=i({},r)).__v=_,l=C(u,r,_,t.__n,void 0!==u.ownerSVGElement,null!=r.__h?[o]:null,n,null==o?h(r):o,r.__h),x(n,r),l!=o&&d(r)))}))}function m(e,t,n,_,l,u,i,s,p,d){var v,y,m,k,b,w,S,A=_&&_.__k||o,x=A.length;for(p==r&&(p=null!=i?i[0]:x?h(_,0):null),n.__k=[],v=0;v<t.length;v++)if(null!=(k=n.__k[v]=null==(k=t[v])||"boolean"==typeof k?null:"string"==typeof k||"number"==typeof k?a(null,k,null,null,k):Array.isArray(k)?a(f,{children:k},null,null,null):null!=k.__e||null!=k.__c?a(k.type,k.props,k.key,null,k.__v):k)){if(k.__=n,k.__b=n.__b+1,null===(m=A[v])||m&&k.key==m.key&&k.type===m.type)A[v]=void 0;else for(y=0;y<x;y++){if((m=A[y])&&k.key==m.key&&k.type===m.type){A[y]=void 0;break}m=null}b=C(e,k,m=m||r,l,u,i,s,p,d),(y=k.ref)&&m.ref!=y&&(S||(S=[]),m.ref&&S.push(m.ref,null,k),S.push(y,k.__c||b,k)),null!=b?(null==w&&(w=b),p=g(e,k,m,A,i,b,p),d||"option"!=n.type?"function"==typeof n.type&&(n.__d=p):e.value=""):p&&m.__e==p&&p.parentNode!=e&&(p=h(m))}if(n.__e=w,null!=i&&"function"!=typeof n.type)for(v=i.length;v--;)null!=i[v]&&c(i[v]);for(v=x;v--;)null!=A[v]&&N(A[v],A[v]);if(S)for(v=0;v<S.length;v++)E(S[v],S[++v],S[++v])}function g(e,t,n,_,l,r,o){var u,i,c;if(void 0!==t.__d)u=t.__d,t.__d=void 0;else if(l==n||r!=o||null==r.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(r),u=null;else{for(i=o,c=0;(i=i.nextSibling)&&c<_.length;c+=2)if(i==r)break e;e.insertBefore(r,o),u=o}return void 0!==u?u:r.nextSibling}function k(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||u.test(t)?n:n+"px"}function b(e,t,n,_,l){var r,o,u;if(l&&"className"==t&&(t="class"),"style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof _&&(e.style.cssText=_=""),_)for(t in _)n&&t in n||k(e.style,t,"");if(n)for(t in n)_&&n[t]===_[t]||k(e.style,t,n[t])}else"o"===t[0]&&"n"===t[1]?(r=t!==(t=t.replace(/Capture$/,"")),(o=t.toLowerCase())in e&&(t=o),t=t.slice(2),e.l||(e.l={}),e.l[t+r]=n,u=r?S:w,n?_||e.addEventListener(t,u,r):e.removeEventListener(t,u,r)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&"download"!==t&&"href"!==t&&!l&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function w(t){this.l[t.type+!1](e.event?e.event(t):t)}function S(t){this.l[t.type+!0](e.event?e.event(t):t)}function A(e,t,n){var _,l;for(_=0;_<e.__k.length;_++)(l=e.__k[_])&&(l.__=e,l.__e&&("function"==typeof l.type&&l.__k.length>1&&A(l,t,n),t=g(n,l,l,e.__k,null,l.__e,t),"function"==typeof e.type&&(e.__d=t)))}function C(t,n,_,l,r,o,u,c,s){var a,h,d,v,y,g,k,b,w,S,C,x=n.type;if(void 0!==n.constructor)return null;null!=_.__h&&(s=_.__h,c=n.__e=_.__e,n.__h=null,o=[c]),(a=e.__b)&&a(n);try{e:if("function"==typeof x){if(b=n.props,w=(a=x.contextType)&&l[a.__c],S=a?w?w.props.value:a.__:l,_.__c?k=(h=n.__c=_.__c).__=h.__E:("prototype"in x&&x.prototype.render?n.__c=h=new x(b,S):(n.__c=h=new p(b,S),h.constructor=x,h.render=P),w&&w.sub(h),h.props=b,h.state||(h.state={}),h.context=S,h.__n=l,d=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=x.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=i({},h.__s)),i(h.__s,x.getDerivedStateFromProps(b,h.__s))),v=h.props,y=h.state,d)null==x.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==x.getDerivedStateFromProps&&b!==v&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,S),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,S)||n.__v===_.__v){h.props=b,h.state=h.__s,n.__v!==_.__v&&(h.__d=!1),h.__v=n,n.__e=_.__e,n.__k=_.__k,h.__h.length&&u.push(h),A(n,c,t);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,S),null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(v,y,g)}))}h.context=S,h.props=b,h.state=h.__s,(a=e.__r)&&a(n),h.__d=!1,h.__v=n,h.__P=t,a=h.render(h.props,h.state,h.context),h.state=h.__s,null!=h.getChildContext&&(l=i(i({},l),h.getChildContext())),d||null==h.getSnapshotBeforeUpdate||(g=h.getSnapshotBeforeUpdate(v,y)),C=null!=a&&a.type==f&&null==a.key?a.props.children:a,m(t,Array.isArray(C)?C:[C],n,_,l,r,o,u,c,s),h.base=n.__e,n.__h=null,h.__h.length&&u.push(h),k&&(h.__E=h.__=null),h.__e=!1}else null==o&&n.__v===_.__v?(n.__k=_.__k,n.__e=_.__e):n.__e=H(_.__e,n,_,l,r,o,u,s);(a=e.diffed)&&a(n)}catch(t){n.__v=null,(s||null!=o)&&(n.__e=c,n.__h=!!s,o[o.indexOf(c)]=null),e.__e(t,n,_)}return n.__e}function x(t,n){e.__c&&e.__c(n,t),t.some((function(n){try{t=n.__h,n.__h=[],t.some((function(e){e.call(n)}))}catch(t){e.__e(t,n.__v)}}))}function H(e,t,n,_,l,u,i,c){var s,a,f,p,h,d=n.props,v=t.props;if(l="svg"===t.type||l,null!=u)for(s=0;s<u.length;s++)if(null!=(a=u[s])&&((null===t.type?3===a.nodeType:a.localName===t.type)||e==a)){e=a,u[s]=null;break}if(null==e){if(null===t.type)return document.createTextNode(v);e=l?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,v.is&&{is:v.is}),u=null,c=!1}if(null===t.type)d===v||c&&e.data===v||(e.data=v);else{if(null!=u&&(u=o.slice.call(e.childNodes)),f=(d=n.props||r).dangerouslySetInnerHTML,p=v.dangerouslySetInnerHTML,!c){if(null!=u)for(d={},h=0;h<e.attributes.length;h++)d[e.attributes[h].name]=e.attributes[h].value;(p||f)&&(p&&(f&&p.__html==f.__html||p.__html===e.innerHTML)||(e.innerHTML=p&&p.__html||""))}(function(e,t,n,_,l){var r;for(r in n)"children"===r||"key"===r||r in t||b(e,r,null,n[r],_);for(r in t)l&&"function"!=typeof t[r]||"children"===r||"key"===r||"value"===r||"checked"===r||n[r]===t[r]||b(e,r,t[r],n[r],_)})(e,v,d,l,c),p?t.__k=[]:(s=t.props.children,m(e,Array.isArray(s)?s:[s],t,n,_,"foreignObject"!==t.type&&l,u,i,r,c)),c||("value"in v&&void 0!==(s=v.value)&&(s!==e.value||"progress"===t.type&&!s)&&b(e,"value",s,d.value,!1),"checked"in v&&void 0!==(s=v.checked)&&s!==e.checked&&b(e,"checked",s,d.checked,!1))}return e}function E(t,n,_){try{"function"==typeof t?t(n):t.current=n}catch(t){e.__e(t,_)}}function N(t,n,_){var l,r,o;if(e.unmount&&e.unmount(t),(l=t.ref)&&(l.current&&l.current!==t.__e||E(l,null,n)),_||"function"==typeof t.type||(_=null!=(r=t.__e)),t.__e=t.__d=void 0,null!=(l=t.__c)){if(l.componentWillUnmount)try{l.componentWillUnmount()}catch(t){e.__e(t,n)}l.base=l.__P=null}if(l=t.__k)for(o=0;o<l.length;o++)l[o]&&N(l[o],n,_);null!=r&&c(r)}function P(e,t,n){return this.constructor(e,n)}e={__e:function(e,t){for(var n,_,l,r=t.__h;t=t.__;)if((n=t.__c)&&!n.__)try{if((_=n.constructor)&&null!=_.getDerivedStateFromError&&(n.setState(_.getDerivedStateFromError(e)),l=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),l=n.__d),l)return t.__h=r,n.__E=n}catch(t){e=t}throw e}},p.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=i({},this.state),"function"==typeof e&&(e=e(i({},n),this.props)),e&&i(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),v(this))},p.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),v(this))},p.prototype.render=f,t=[],n="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,y.__r=0,l=r;var T,D,F,U=0,L=[],M=e.__r,W=e.diffed,q=e.__c,I=e.unmount;function R(t,n){e.__h&&e.__h(D,t,U||n),U=0;var _=D.__H||(D.__H={__:[],__h:[]});return t>=_.__.length&&_.__.push({}),_.__[t]}function z(e){return U=1,function(e,t,n){var _=R(T++,2);return _.t=e,_.__c||(_.__=[n?n(t):$(void 0,t),function(e){var t=_.t(_.__[0],e);_.__[0]!==t&&(_.__=[t,_.__[1]],_.__c.setState({}))}],_.__c=D),_.__}($,e)}function X(t,n){var _=R(T++,3);!e.__s&&V(_.__H,n)&&(_.__=t,_.__H=n,D.__H.__h.push(_))}function B(e){return U=5,function(e,t){var n=R(T++,7);return V(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}((function(){return{current:e}}),[])}function O(){L.some((function(t){if(t.__P)try{t.__H.__h.forEach(j),t.__H.__h.forEach(G),t.__H.__h=[]}catch(n){return t.__H.__h=[],e.__e(n,t.__v),!0}})),L=[]}e.__r=function(e){M&&M(e),T=0;var t=(D=e.__c).__H;t&&(t.__h.forEach(j),t.__h.forEach(G),t.__h=[])},e.diffed=function(t){W&&W(t);var n=t.__c;n&&n.__H&&n.__H.__h.length&&(1!==L.push(n)&&F===e.requestAnimationFrame||((F=e.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(_),Y&&cancelAnimationFrame(t),setTimeout(e)},_=setTimeout(n,100);Y&&(t=requestAnimationFrame(n))})(O))},e.__c=function(t,n){n.some((function(t){try{t.__h.forEach(j),t.__h=t.__h.filter((function(e){return!e.__||G(e)}))}catch(_){n.some((function(e){e.__h&&(e.__h=[])})),n=[],e.__e(_,t.__v)}})),q&&q(t,n)},e.unmount=function(t){I&&I(t);var n=t.__c;if(n&&n.__H)try{n.__H.__.forEach(j)}catch(t){e.__e(t,n.__v)}};var Y="function"==typeof requestAnimationFrame;function j(e){"function"==typeof e.u&&e.u()}function G(e){e.u=e.__()}function V(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function $(e,t){return"function"==typeof t?t(e):t}const J=[],K=e=>{const t=new Set;return[()=>{const n=z()[1];return X((()=>(t.add(n),()=>t.delete(n))),J),e},n=>{e="function"==typeof n?n(e):n;for(const n of t)n(e)}]};class Q{constructor(e,t){this.X=e,this.Y=t,this.buffer=new Uint32Array(Math.ceil(e*t/32))}get(e,t){const{X:n,Y:_,buffer:l}=this,r=(t<0?t%_+_:t%_)*n+(e<0?e%n+n:e%n);return l[r>>5]&1<<(31&r)?1:0}set(e,t,n){const _=t*this.X+e;n?this.buffer[_>>5]|=1<<(31&_):this.buffer[_>>5]&=~(1<<(31&_))}}const Z=(e,t,n=.25)=>{const _=new Q(e,t);for(let l=0;l<t;l++)for(let t=0;t<e;t++)Math.random()<n&&_.set(t,l,1);return _},ee=(te=[2,3],ne=[3],(e,t,n)=>{const _=e.get(t-1,n-1)+e.get(t,n-1)+e.get(t+1,n-1)+e.get(t-1,n)+e.get(t+1,n)+e.get(t-1,n+1)+e.get(t,n+1)+e.get(t+1,n+1);return e.get(t,n)?te.includes(_):ne.includes(_)});var te,ne;const _e=(e,t=ee)=>{const{X:n,Y:_}=e,l=new Q(n,_);for(let r=0;r<_;r++)for(let _=0;_<n;_++)t(e,_,r)&&l.set(_,r,1);return l},le=(e,t)=>{const n=Array(e);for(let _=0;_<e;_++)n[_]=t(_);return n},re=3,oe=128,ue=128,[ie,ce]=K(re),[se,ae]=K(oe),[fe,pe]=K(ue),[he,de]=K(Z(oe,ue)),[ve,ye]=K(!1),[me,ge]=K(0),ke=({x:e,y:t})=>{const n=ie();return s("td",{className:he().get(e,t)?"cell cell-alive":"cell",style:{width:n,height:n}})},be=({y:e})=>{const t=se();return s("tr",null,le(t,(t=>s(ke,{key:t,x:t,y:e}))))},we=()=>{const e=fe();return s("table",{style:{tableLayout:"fixed"}},le(e,(e=>s(be,{key:e,y:e}))))},Se=({onClick:e,children:t})=>s("button",{type:"button",onClick:e},t),Ae=()=>{const e=ie(),t=se(),n=fe(),_=ve(),l=me();return s("aside",null,s("table",null,s("tbody",null,s("tr",null,s("td",null,"Cell Size:"),s("td",null,s("input",{type:"number",min:0,value:e,onChange:e=>ce(e.currentTarget.valueAsNumber)}))),s("tr",null,s("td",null,"World Width:"),s("td",null,s("input",{type:"number",min:0,value:t,onChange:e=>ae(e.currentTarget.valueAsNumber)}))),s("tr",null,s("td",null,"World Height:"),s("td",null,s("input",{type:"number",min:0,value:n,onChange:e=>pe(e.currentTarget.valueAsNumber)}))))),_?s(Se,{onClick:()=>ye(!1)},"Stop"):s(Se,{onClick:()=>ye(!0)},"Start"),s(Se,{onClick:()=>de(Z(t,n))},"Randomize"),s("div",null,l," fps"))},Ce=({href:e,children:t})=>s("a",{target:"_blank",rel:"noopener noreferrer",href:e},t);!function(t,n,_){var u,i,c;e.__&&e.__(t,n),i=(u=_===l)?null:_&&_.__k||n.__k,t=s(f,null,[t]),c=[],C(n,(u?n:_||n).__k=t,i||r,r,void 0!==n.ownerSVGElement,_&&!u?[_]:i?null:n.childNodes.length?o.slice.call(n.childNodes):null,c,_||r,u),x(c,t)}(s((()=>{const e=se(),t=fe(),n=ve(),[_,l]=z(void 0),r=B(!0);return X((()=>{n?l((()=>((e,t)=>{let n=0,_=Date.now(),l=0,r=requestAnimationFrame((function t(){l||(e(),n++,r=requestAnimationFrame(t))})),o=setInterval((()=>{let e=Date.now();t(1e3*n/(e-_)|0),n=0,_=e}),512);return()=>{l=1,cancelAnimationFrame(r),clearInterval(o)}})((()=>de(_e)),ge))):(_?.(),l(void 0))}),[n]),X((()=>{r.current?r.current=!1:de(Z(e,t))}),[e,t]),s(f,null,s("h1",{style:{textAlign:"center"}},s(Ce,{href:"https://preactjs.com/"},"Preact")," + ",s(Ce,{href:"https://github.com/luncheon/preact-shared-state-hook"},"preact-shared-state-hook")),s("main",null,s(we,null),s(Ae,null)))}),null),document.body.appendChild(document.createElement("div")))}();
